import { createClientComponentClient } from "@supabase/auth-helpers-nextjs"; import { NextResponse } from "next/server"; export async function GET(request) { try { const supabase = createClientComponentClient(); const { data: { session } } = await supabase.auth.getSession(); if (!session) { return NextResponse.json({ error: "Unauthorized" }, { status: 401 }); } const { data: applications, error } = await supabase.from("cross_promotion_applications").select("id, opportunity_id, newsletter_name, description, budget, status, created_at, admin_notes").eq("user_id", session.user.id).order("created_at", { ascending: false }); if (error) { return NextResponse.json({ error: "Failed to fetch applications" }, { status: 500 }); } return NextResponse.json({ success: true, applications: applications || [] }); } catch (error) { return NextResponse.json({ error: "Internal server error" }, { status: 500 }); } }
